---
redirect_from:
  - "/03/experiments-faces-hq/faces-hq"
interact_link: content/03/Experiments_Faces-HQ/Faces-HQ.ipynb
kernel_name: python3
kernel_path: content/03/Experiments_Faces-HQ
has_widgets: false
title: |-
  Detection Faces-HQ
pagenum: 3
prev_page:
  url: /results.html
next_page:
  url: /03/Experiments_CelebA/CelebA.html
suffix: .ipynb
search: features create spectrum faces hq notebook pre computed ones sure plot r check show results scratch feature want download data link cutt ly endlyg save folder together otherwise just jump section loading load either created label distribution balanced dataset datasetfreq pkl calculation python sos classification classify using

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Detection Faces-HQ</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Faces-HQ">Faces-HQ<a class="anchor-link" href="#Faces-HQ"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this notebook we show the results for Faces-HQ. You can create from scratch the features or use the pre-computed ones.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-Create-feature">1. Create feature<a class="anchor-link" href="#1.-Create-feature"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you want to create the features, first of all download the data from <a href="https://cutt.ly/6enDLYG">link</a>. Be sure to save the folder together with this notebook.</p>
<h3 id="Otherwise,-just-jump-to-section-2.">Otherwise, just jump to section 2.<a class="anchor-link" href="#Otherwise,-just-jump-to-section-2."> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import cv2</span>
<span class="c1"># import numpy as np</span>
<span class="c1"># import os</span>
<span class="c1"># import radialProfile</span>
<span class="c1"># import glob</span>
<span class="c1"># from matplotlib import pyplot as plt</span>
<span class="c1"># import pickle</span>
<span class="c1"># </span>
<span class="c1"># path = [&#39;thispersondoesntexists&#39;, &#39;100KFake&#39;, &#39;Flickr-Faces-HQ2_&#39;, &#39;celebA-HQ_10K&#39;]</span>
<span class="c1"># labels = [1, 1, 0, 0]</span>
<span class="c1"># format_file = [&#39;jpg&#39;, &#39;jpg&#39;, &#39;jpg&#39;, &#39;jpg&#39;]</span>
<span class="c1"># epsilon = 1e-8</span>
<span class="c1"># data = {}</span>
<span class="c1"># # number of samples from each dataset</span>
<span class="c1"># stop = 250</span>
<span class="c1"># number_iter = 4 * stop</span>
<span class="c1"># psd1D_total = np.zeros([number_iter, 722])</span>
<span class="c1"># label_total = np.zeros([number_iter])</span>
<span class="c1"># iter_ = 0</span>
<span class="c1"># </span>
<span class="c1"># for z in range(4):</span>
<span class="c1">#     cont = 0</span>
<span class="c1">#     psd1D_average_org = np.zeros(722)</span>
<span class="c1">#     print(path[z])</span>
<span class="c1"># </span>
<span class="c1">#     for filename in glob.glob(path[z] + &quot;/*.&quot; + format_file[z]):</span>
<span class="c1">#         img = cv2.imread(filename, 0)</span>
<span class="c1">#         f = np.fft.fft2(img)</span>
<span class="c1">#         fshift = np.fft.fftshift(f)</span>
<span class="c1">#         fshift += epsilon</span>
<span class="c1"># </span>
<span class="c1">#         magnitude_spectrum = 20 * np.log(np.abs(fshift))</span>
<span class="c1"># </span>
<span class="c1">#         # Calculate the azimuthally averaged 1D power spectrum</span>
<span class="c1">#         psd1D = radialProfile.azimuthalAverage(magnitude_spectrum)</span>
<span class="c1">#         psd1D_total[iter_, :] = psd1D</span>
<span class="c1">#         label_total[iter_] = labels[z]</span>
<span class="c1"># </span>
<span class="c1">#         cont += 1</span>
<span class="c1">#         iter_ += 1</span>
<span class="c1">#         if cont &gt;= stop:</span>
<span class="c1">#             break</span>
<span class="c1"># </span>
<span class="c1"># data[&quot;data&quot;] = psd1D_total</span>
<span class="c1"># data[&quot;label&quot;] = label_total</span>
<span class="c1"># </span>
<span class="c1"># output = open(&#39;dataset_freq_1000.pkl&#39;, &#39;wb&#39;)</span>
<span class="c1"># pickle.dump(data, output)</span>
<span class="c1"># output.close()</span>
<span class="c1"># print(&quot;DATA Saved&quot;)    </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>thispersondoesntexists
100KFake
Flickr-Faces-HQ2_
celebA-HQ_10K
DATA Saved
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Loading-Features">2. Loading Features<a class="anchor-link" href="#2.-Loading-Features"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we load the features. Either the pre-computed ones or the features that you have created.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># load feature file</span>
<span class="n">pkl_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dataset_freq_1000.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkl_file</span><span class="p">)</span>
<span class="n">pkl_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We look at the label distribution, to be sure that we have a balanced dataset.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f58511d1e10&gt;]</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/03/Experiments_Faces-HQ/Faces-HQ_9_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plot-of--dataset_freq_1000.pkl-in-R">Plot of  dataset_freq_1000.pkl in R<a class="anchor-link" href="#Plot-of--dataset_freq_1000.pkl-in-R"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">use</span> R
<span class="o">%</span><span class="k">get</span> y --from Python3
<span class="c1"># Libraries</span>
<span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1"># create data</span>
<span class="n">xvalue</span> <span class="o">&lt;-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2000</span>
<span class="n">yvalue</span> <span class="o">&lt;-</span> <span class="n">cumsum</span><span class="p">(</span><span class="n">rnorm</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">data</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">xvalue</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c1">#print(y)</span>
<span class="c1"># Plot</span>
<span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xvalue</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="n">geom_line</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-Check-Spectrum">3. Check Spectrum<a class="anchor-link" href="#3.-Check-Spectrum"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have a look to the spectrum</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_feat</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">psd1D_org_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span><span class="n">num_feat</span><span class="p">))</span>
<span class="n">psd1D_org_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span><span class="n">num_feat</span><span class="p">))</span>
<span class="n">psd1D_org_0_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_feat</span><span class="p">)</span>
<span class="n">psd1D_org_0_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_feat</span><span class="p">)</span>
<span class="n">psd1D_org_1_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_feat</span><span class="p">)</span>
<span class="n">psd1D_org_1_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_feat</span><span class="p">)</span>

<span class="n">cont_0</span><span class="o">=</span><span class="mi">0</span>
<span class="n">cont_1</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># We separate real and fake using the label</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">psd1D_org_0</span><span class="p">[</span><span class="n">cont_0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">x</span><span class="p">,:]</span>
        <span class="n">cont_0</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">psd1D_org_1</span><span class="p">[</span><span class="n">cont_1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">x</span><span class="p">,:]</span>
        <span class="n">cont_1</span><span class="o">+=</span><span class="mi">1</span>

<span class="c1"># We compute statistcis</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_feat</span><span class="p">):</span>
    <span class="n">psd1D_org_0_mean</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">psd1D_org_0</span><span class="p">[:,</span><span class="n">x</span><span class="p">])</span>
    <span class="n">psd1D_org_0_std</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">psd1D_org_0</span><span class="p">[:,</span><span class="n">x</span><span class="p">])</span>
    <span class="n">psd1D_org_1_mean</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">psd1D_org_1</span><span class="p">[:,</span><span class="n">x</span><span class="p">])</span>
    <span class="n">psd1D_org_1_std</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">psd1D_org_1</span><span class="p">[:,</span><span class="n">x</span><span class="p">])</span>
    
<span class="c1"># Plot</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_feat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">psd1D_org_0_mean</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">psd1D_org_0_mean</span> <span class="o">-</span> <span class="n">psd1D_org_0_std</span><span class="p">,</span> <span class="n">psd1D_org_0_mean</span> <span class="o">+</span> <span class="n">psd1D_org_0_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">psd1D_org_1_mean</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fake&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">psd1D_org_1_mean</span> <span class="o">-</span> <span class="n">psd1D_org_1_std</span><span class="p">,</span> <span class="n">psd1D_org_1_mean</span> <span class="o">+</span> <span class="n">psd1D_org_1_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Spatial Frequency&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Power Spectrum&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;Power Spectrum&#39;)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/03/Experiments_Faces-HQ/Faces-HQ_14_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-Spectrum-Calculation-in--R,-plot-in-Python---SOS">Check Spectrum Calculation in  R, plot in Python - SOS<a class="anchor-link" href="#Check-Spectrum-Calculation-in--R,-plot-in-Python---SOS"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_feat</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">psd1D_org_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span><span class="n">num_feat</span><span class="p">))</span>
<span class="n">psd1D_org_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span><span class="n">num_feat</span><span class="p">))</span>
<span class="n">psd1D_org_0_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_feat</span><span class="p">)</span>
<span class="n">psd1D_org_0_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_feat</span><span class="p">)</span>
<span class="n">psd1D_org_1_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_feat</span><span class="p">)</span>
<span class="n">psd1D_org_1_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_feat</span><span class="p">)</span>

<span class="n">cont_0</span><span class="o">=</span><span class="mi">0</span>
<span class="n">cont_1</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># We separate real and fake using the label</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">psd1D_org_0</span><span class="p">[</span><span class="n">cont_0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">x</span><span class="p">,:]</span>
        <span class="n">cont_0</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">psd1D_org_1</span><span class="p">[</span><span class="n">cont_1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">x</span><span class="p">,:]</span>
        <span class="n">cont_1</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">use</span> R
<span class="o">%</span><span class="k">get</span> num_feat --from Python3
<span class="o">%</span><span class="k">get</span> psd1D_org_0 --from Python3
<span class="o">%</span><span class="k">get</span> psd1D_org_1 --from Python3
<span class="o">%</span><span class="k">get</span> psd1D_org_0_mean --from Python3
<span class="o">%</span><span class="k">get</span> psd1D_org_0_std --from Python3
<span class="o">%</span><span class="k">get</span> psd1D_org_1_mean --from Python3
<span class="o">%</span><span class="k">get</span> psd1D_org_1_std --from Python3

<span class="k">for</span> <span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">num_feat</span><span class="p">)){</span>
    <span class="n">psd1D_org_0_mean</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">psd1D_org_0</span><span class="p">[(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">),</span><span class="n">x</span><span class="p">])</span>
    <span class="n">psd1D_org_0_std</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">sd</span><span class="p">(</span><span class="n">psd1D_org_0</span><span class="p">[(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">),</span><span class="n">x</span><span class="p">])</span>
    <span class="n">psd1D_org_1_mean</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">psd1D_org_1</span><span class="p">[(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">),</span><span class="n">x</span><span class="p">])</span>
    <span class="n">psd1D_org_1_std</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">sd</span><span class="p">(</span><span class="n">psd1D_org_1</span><span class="p">[(</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">),</span><span class="n">x</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">get</span> num_feat --from R
<span class="o">%</span><span class="k">get</span> psd1D_org_0 --from R
<span class="o">%</span><span class="k">get</span> psd1D_org_1 --from R
<span class="o">%</span><span class="k">get</span> psd1D_org_0_mean --from R
<span class="o">%</span><span class="k">get</span> psd1D_org_0_std --from R
<span class="o">%</span><span class="k">get</span> psd1D_org_1_mean --from R
<span class="o">%</span><span class="k">get</span> psd1D_org_1_std --from R

<span class="c1"># Plot</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_feat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">psd1D_org_0_mean</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fake&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">psd1D_org_0_mean</span> <span class="o">-</span> <span class="n">psd1D_org_0_std</span><span class="p">,</span> <span class="n">psd1D_org_0_mean</span> <span class="o">+</span> <span class="n">psd1D_org_0_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">psd1D_org_1_mean</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">psd1D_org_1_mean</span> <span class="o">-</span> <span class="n">psd1D_org_1_std</span><span class="p">,</span> <span class="n">psd1D_org_1_mean</span> <span class="o">+</span> <span class="n">psd1D_org_1_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Spatial Frequency&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Power Spectrum&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;1000_celeba.png&#39;, bbox_inches=&#39;tight&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-Classification">4. Classification<a class="anchor-link" href="#4.-Classification"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we classify using the features.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">LR</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">SVM</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="c1"># read python dict back from the file</span>
    <span class="n">pkl_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dataset_freq_1000.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkl_file</span><span class="p">)</span>

    <span class="n">pkl_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
        <span class="n">svclassifier</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
        <span class="n">svclassifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="c1">#print(&#39;Accuracy on test set: {:.3f}&#39;.format(svclassifier.score(X_test, y_test)))</span>
        
        <span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
        <span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="c1">#print(&#39;Accuracy on test set: {:.3f}&#39;.format(logreg.score(X_test, y_test)))</span>

        
        <span class="n">SVM</span><span class="o">+=</span><span class="n">svclassifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
        <span class="n">LR</span><span class="o">+=</span><span class="n">logreg</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

 
    <span class="k">except</span><span class="p">:</span>
        <span class="n">num</span><span class="o">-=</span><span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average SVM: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SVM</span><span class="o">/</span><span class="n">num</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average LR: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">LR</span><span class="o">/</span><span class="n">num</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Average SVM: 1.0
Average LR: 1.0
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/anaconda3/lib/python3.6/site-packages/sklearn/svm/base.py:193: FutureWarning: The default value of gamma will change from &#39;auto&#39; to &#39;scale&#39; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#39;auto&#39; or &#39;scale&#39; to avoid this warning.
  &#34;avoid this warning.&#34;, FutureWarning)
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

 


    </main>
    